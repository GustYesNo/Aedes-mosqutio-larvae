<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>แบบฟอร์มการสำรวจลูกน้ำยุงลาย</title>
  <style>
    body {
      font-family: "Tahoma", sans-serif;
      background: #f2f6fc;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
       /* ส่วนหัวกล่อง */
    .header {
      background:  #008000;
      text-align: center;
      padding: 20px;
      color: white;
    }
    .header img {
      width: 70px;
      display: block;
      margin: 0 auto 10px;
    }
    .header h3 {
      margin: 0;
      font-size: 1.2em;
    }
    }
    h2 {
      text-align: center;
      color: #333;
      margin-bottom: 25px;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
      color: #444;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
    }
    button {
      background: #0078D7;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #005a9e;
    }
    .result {
      margin-top: 25px;
      padding: 15px;
      text-align: center;
      font-weight: bold;
      font-size: 16px;
      line-height: 1.8;
    }
    .green { color: green; font-weight: bold; }
    .red { color: red; font-weight: bold; }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <img src="logo.png" alt="Logo">
    <h3>ศูนย์บริการสาธารณสุขเทศบาลนครนนทุบุรีที่ 8 บางเขน</h3>
  </div>

  <h2>การสำรวจลูกน้ำยุงลาย งานควบคุมโรคติดต่อ</h2>

  <!-- เลือกเดือน -->
  <label>เลือกเดือน</label>
  <select id="month">
    <option value="">-- เลือกเดือน --</option>
    <option>มกราคม</option><option>กุมภาพันธ์</option><option>มีนาคม</option>
    <option>เมษายน</option><option>พฤษภาคม</option><option>มิถุนายน</option>
    <option>กรกฎาคม</option><option>สิงหาคม</option><option>กันยายน</option>
    <option>ตุลาคม</option><option>พฤศจิกายน</option><option>ธันวาคม</option>
  </select>

  <!-- เลือกชุมชน -->
  <label>เลือกชุมชน</label>
  <select id="community">
      <option value="">-- เลือกชุมชน --</option>
      <option>หมู่ 3 จาริพิบูลย์</option>
      <option>หมู่ 3 วัดฝาง</option>
      <option>หมู่ 4 บางเขน</option>
      <option>หมู่ 5 สันติบางเขน</option>
      <option>หมู่ 6 ศิริโชติ-สวัสดิ์กิจ</option>
      <option>หมู่ 6 ศิริชัย</option>
      <option>หมู่ 6 วัดทางหลวง</option>
      <option>หมู่ 7 ศิริชัยพัฒนา</option>
      <option>หมู่ 7 วัดโพธิ์ทองล่าง</option>
  </select>

  <!-- เลือก อสม. -->
  <label>รายชื่อ อสม.</label>
  <select id="healthVolunteer">
    <option value="">-- เลือก อสม. --</option>
  </select>

  <!-- เลือกสถานที่ -->
  <label>สถานที่</label>
  <select id="placeType">
    <option value="">-- เลือกสถานที่ --</option>
    <option>บ้าน</option>
    <option>วัด/ศาสนสถาน</option>
    <option>โรงเรียน</option>
    <option>โรงพยาบาล</option>
    <option>โรงแรม/คอนโด</option>
    <option>โรงงาน</option>
  </select>

  <!-- ฟิลด์กรอกข้อมูล -->
  <label>1) จำนวนภาชนะที่สำรวจ (CI)</label>
  <input type="number" id="containerTotal">

  <label>2) จำนวนภาชนะที่พบลูกน้ำยุงลาย (CI)</label>
  <input type="number" id="containerPositive">

  <label>3) จำนวนหลังคาเรือนที่สำรวจ (HI)</label>
  <input type="number" id="houseTotal">

  <label>4) จำนวนหลังคาเรือนที่พบลูกน้ำยุงลาย (HI)</label>
  <input type="number" id="housePositive">

  <button onclick="calculate()">ส่ง</button>

  <div class="result" id="result"></div>
</div>

<script>
  const volunteers = {
    "หมู่ 3 จาริพิบูลย์": ["อสม.วิเชียร นวลปลอด", "อสม.อุทัยวรรณ สมสิทธิ์", "อสม.สำรวย พันธุ์ดา", "อสม.สารภี ตั้งธรรม",
       "อสม.ฟรี ทองประกอบ", "อสม.อมรชนก นวลปลอด", "อสม.ประเสริฐ แจ่มจันทร์", "อสม.วินัย นนทเกียรติกุล", "อสม.ปราณี สังข์แก้ว", 
       "อสม.บุญเตือน พงษ์มาลา", "อสม.จริยา ทองสีนาค", "อสม.วรกาญจน์ วรโชติพงศักดิ์", "อสม.สุวรรณี บุญพิทักษ์", "อสม.สุกัญญา เบญยมาตร", "อสม.กาญจนา แก้วทับ"],
    "หมู่ 3 วัดฝาง": ["อสม.สุพรรณี เนติประเสริฐ","อสม.หทัยชนก หาวุฒิ","อสม.วิภาวัลย์ เกรียงเกร็ด","อสม.เกษม โตเจริญ",
        "อสม.ผ่องพรรณ ภู่สุวรรณ","อสม.สุวัลลีย์ ประสงค์","อสม.วิไลรัตน์ กัญจนา","อสม.ปทุม ทองคำ","อสม.สุมาลี แสงชูโต",
        "อสม.ป้อม น้ำเพชร","อสม.ประกอบ ดิษฐใจเย็น","อสม.กัลยา นิ่มทอง","อสม.ลักลุณี ปั้นสุวรรณ"],
    "หมู่ 4 บางเขน": ["อสม.ถนอม พยัคโส","อสม.จิรศักดิ์ แสงนุภา","อสม.ปราณี พยัคโส","อสม.รินดา ศรีแก้ว","อสม.ธีระยุทธ ศรีแก้ว",
        "อสม.สอาด พรมเวียง","อสม.นพรัตน์ เส็งดอนไพร","อสม.สงัด สอนศรี","อสม.สมภูมิ สุวรรณลพ","อสม.ทรงยศ แก้วแกมสี"],
    "หมู่ 5 บางเขน": ["อสม.พีรลิน ฐิติไชโย","อสม.กลอยใจ สุทธิพร","อสม.วรรณา ณ นคร","อสม.ปิยะวร ศรีลักษณ์","อสม.เดชา กลิ่นประยงค์","อสม.หวัน เนตรดวงตา",
        "อสม.วีระพงษ์ เนตรดวงตา","อสม.สุวรรณา นาคทอง","อสม.จินดา ตำนานจิต","อสม.อุไรพร ใจทับทิม",],
    "หมู่ 6 ศิริโชติ-สวัสดิ์กิจ": ["อสม.สมกฤษ ขันสำลี","อสม.พรวรินทร์ เย็นพิบูลย์","อสม.กิ่งดาว กลิ่นเกษร","อสม.สุภาภรณ์ วรรณา","อสม.สมจิตร ขันสำรี",
        "อสม.อนงค์พร ฉัตรพรไพบูลย์","อสม.ปราณี วรพุฒ์","อสม.ต้อย ไชยฤทธิ์","อสม.สุขสม ธรมธัช","อสม.วิลัยลักษณ์ ฉันทศิริ","อสม.สมทรง โพธิ์กลาง",
        "อสม.ไทรงาม ศรีภักดิ์","อสม.ธนะสิน ธรรมสาร","อสม.รุจิกร ร่มสนธิ์","อสม.จรรยา โตขำ"],
    "หมู่ 6 ศิริชัย": ["อสม.สุมาลี จีนเอ็ม","อสม.ประภัสสร สุขคำดี","อสม.ทองหยาด ใจอารีย์","อสม.ปิยรัตน์ จีนเอม","อสม.จิดาภา ตันเสียดี",
        "อสม.พิศมัย เรืองลาภ","อสม.ณัฐชยา นนตะ","อสม.สุรีย์ งามชื่น","อสม.น้อม เรืองยุบล","อสม.โสภา พิณศรี","อสม.สำรวม พจน์ด้วง",
        "อสม.ปีณธี ศรีสถิตย์ธรรม","อสม.ยุคลทร อุบลแย้ม","อสม.สุมาลี พูลเพ็ชร"],
    "หมู่ 6 วัดทางหลวง": ["อสม.สมเกียรติ  คงตาดำ", "อสม.ชุรี ลายทุ้ย","อสม.สาวพเยาว์ อิ่มแจ่มจิตต์","อสม.สุชาดา จันทวาท","อสม.มณฑิชญา วรุณคุปต์",
        "อสม.ธัญญลักษณ์ โพคี","อสม.จำเนียร ทองอ่อน","อสม.สมใจ พัวผดุงดิษฐ์","อสม.ปภาวรินทร์ เลขยานนท์","อสม.เอี่ยมเง็ก ชวาลสันติ",
        "อสม.สมสมัย ศิริกุลบดี","อสม.วีรชาติ เย็นรมย์","อสม.ยุทธพงษ์ คัมภีรพงศ์","อสม.แก้วใจ คงตาดำ","อสม.วิภา สร้อยทอง"],
    "หมู่ 7 ศิริชัยพัฒนา": ["อสม.สมจิตต์ วุฒิสุทธิ์","อสม.พเยาว์ ฝึกศิลป์","อสม.วัชรา มณีอินทร์","อสม.บุญมา จีนเอม",
        "อสม.เสน่ห์ คงคานิ่ง","อสม.สุรัตน์ดา สำราญพานิช","อสม.สมร สำราญพานิชย์","อสม.สมจิตร สำราญพานิชย์","อสม.สำราญ สีเมฆ","อสม.อุบล วุฒิสุทธิ์",
        "อสม.อุบล วุฒิสุทธิ์","อสม.บุญส่ง พุดจันทึก","อสม.บุญมี ซาหมื่นไวย์","อสม.นรินทร์ แก้วทิมา","อสม.สุรีพรรณ ศิริธนะ","อสม.อนุรักษ์ ปริญญานุวัตร",
        "อสม.รัญจวน เค้าหาญ","อสม.สุมาลี เปิ้นมั่นคง","อสม.รมิดา หงษานุภรักษ์"],
    "หมู่ 7 วัดโพธิ์ทองล่าง": ["อสม.มนัส ฤกษ์วิธี", "อสม.เพ็ญทิวา อิงคะวะระ", "อสม.ชญานิษฐ์ วิริยะบุศย์", "อสม.ศรีวัลย์ ฤกษ์วิธี", "อสม.สมปอง พยัคกูล",
        "อสม.วันเพ็ญ จันทนันท์", "อสม.เอมอร อินทร์ศิลา", "อสม.เตือนใจ สัญญะโรจน์", "อสม.สำเริง นุ่มเจริญ", "อสม.อรุณ อุณาพรหม",
        "อสม.สุภาภร แซ่อึ้ง", "อสม.วิรีย์ บัวเขียว", "อสม.บุญเรือน พัดชา", "อสม.ประยูร พิมพ์ทอง", "อสม.ศุภรัตน์ พงษ์โพธิ์", "อสม.ชนันญญา นักพิณพาทย์",
        "อสม.ชุติมล อิงตะวะระ", "อสม.ประพาพรรณ์ ขุนเปีย", "อสม.สมบูรณ์ นพดลกนก", "อสม.บุษบง ดีกล่ำ"]
  };

  document.getElementById("community").addEventListener("change", function() {
    const community = this.value;
    const volunteerSelect = document.getElementById("healthVolunteer");
    volunteerSelect.innerHTML = '<option value="">-- เลือก อสม. --</option>';
    if (volunteers[community]) {
      volunteers[community].forEach(name => {
        let option = document.createElement("option");
        option.value = name;
        option.textContent = name;
        volunteerSelect.appendChild(option);
      });
    }
  });

  function formatNumber(num, decimals) {
  return (num % 1 === 0) ? num.toFixed(0) : num.toFixed(decimals);
}

function calculate() {
    const houseTotal = parseInt(document.getElementById("houseTotal").value) || 0;
    const housePositive = parseInt(document.getElementById("housePositive").value) || 0;
    const containerTotal = parseInt(document.getElementById("containerTotal").value) || 0;
    const containerPositive = parseInt(document.getElementById("containerPositive").value) || 0;

    const HI = houseTotal ? (housePositive * 100 / houseTotal) : 0;
    const CI = containerTotal ? (containerPositive * 100 / containerTotal) : 0;
    const BI = houseTotal ? (containerPositive * 100 / houseTotal) : 0;

    // เก็บค่าความเสี่ยง
    let hiRisk = HI < 10 ? "ไม่มีความเสี่ยง" : "มีความเสี่ยง";
    let ciRisk = CI < 0.002 ? "ไม่มีความเสี่ยง" : "มีความเสี่ยง";
    let biRisk = BI < 50 ? "ไม่มีความเสี่ยง" : "มีความเสี่ยง";

    // แสดงผลรวมจำนวนจริง + % + ความเสี่ยง
    let resultHTML = `

        จำนวนหลังคาเรือนที่พบลูกน้ำยุงลาย (HI): 
        ${formatNumber(HI,2)}% <span class="${HI<10?'green':'red'}">(${hiRisk})</span><br><br>

        จำนวนภาชนะที่พบลูกน้ำยุงลาย (CI):
        ${formatNumber(CI,4)}% <span class="${CI<0.002?'green':'red'}">(${ciRisk})</span><br><br>

        ความชุกของลูกน้ำยุงลาย (BI): 
        ${formatNumber(BI,2)}% <span class="${BI<50?'green':'red'}">(${biRisk})</span>
    `;
    document.getElementById("result").innerHTML = resultHTML;

    // รวมความเสี่ยงทั้งหมดเป็นตัวแปรเพื่อส่งไป Google Sheet
    const riskLevel = ` ${hiRisk},  ${ciRisk},   ${biRisk}`;

    // ส่งข้อมูลไป Google Sheet
    sendToGoogleSheet(HI.toFixed(2), CI.toFixed(4), BI.toFixed(2), riskLevel);
}

// ฟังก์ชันส่งข้อมูลไป Google Sheet
function sendToGoogleSheet(HI, CI, BI, riskLevel) {
    let month = document.getElementById('month').value;
    let community = document.getElementById('community').value;
    let volunteer = document.getElementById('healthVolunteer').value;
    let place = document.getElementById('placeType').value;
    let containerTotal = document.getElementById('containerTotal').value;
    let containerPositive = document.getElementById('containerPositive').value;
    let houseTotal = document.getElementById('houseTotal').value;
    let housePositive = document.getElementById('housePositive').value;

    fetch("https://script.google.com/macros/s/AKfycbyOIXUkBFSCRvPnObNxk6MLeZmf0PW0XgrwXGyRVFUucZXcbgGpbLH9VY4N_HTS5FTwkQ/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            month,
            community,
            volunteer,
            place,
            containerTotal,
            containerPositive,
            houseTotal,
            housePositive,
            HI,
            CI,
            BI,
            riskLevel
        }),
        mode: "no-cors"
    })
    .then(() => console.log("Data sent successfully"))
    .catch(error => console.error("Error:", error));
}
</script>
</body>
</html>








