<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>แบบฟอร์มคำนวณค่า HI CI BI</title>
  <style>
    body {
      font-family: "Tahoma", sans-serif;
      background: #f2f6fc;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
       /* ส่วนหัวกล่อง */
    .header {
      background:  #008000;
      text-align: center;
      padding: 20px;
      color: white;
    }
    .header img {
      width: 70px;
      display: block;
      margin: 0 auto 10px;
    }
    .header h3 {
      margin: 0;
      font-size: 1.2em;
    }
    }
    h2 {
      text-align: center;
      color: #333;
      margin-bottom: 25px;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
      color: #444;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
    }
    button {
      background: #0078D7;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #005a9e;
    }
    .result {
      margin-top: 25px;
      padding: 15px;
      text-align: center;
      font-weight: bold;
      font-size: 16px;
      line-height: 1.8;
    }
    .green { color: green; font-weight: bold; }
    .red { color: red; font-weight: bold; }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <img src="logo.png" alt="Logo">
    <h3>ศูนย์บริการสาธารณสุขเทศบาลนครนนทุบุรีที่ 8 บางเขน</h3>
  </div>

  <h2>การสำรวจลูกน้ำยุงลาย งานควบคุมโรคติดต่อ</h2>

  <!-- เลือกเดือน -->
  <label>เลือกเดือน</label>
  <select id="month">
    <option value="">-- เลือกเดือน --</option>
    <option>มกราคม</option><option>กุมภาพันธ์</option><option>มีนาคม</option>
    <option>เมษายน</option><option>พฤษภาคม</option><option>มิถุนายน</option>
    <option>กรกฎาคม</option><option>สิงหาคม</option><option>กันยายน</option>
    <option>ตุลาคม</option><option>พฤศจิกายน</option><option>ธันวาคม</option>
  </select>

  <!-- เลือกชุมชน -->
  <label>เลือกชุมชน</label>
  <select id="community">
      <option value="">-- เลือกชุมชน --</option>
      <option>หมู่ 3 จาริพิบูลย์</option>
      <option>หมู่ 3 วัดฝาง</option>
      <option>หมู่ 4 บางเขน</option>
      <option>หมู่ 5 บางเขน</option>
      <option>หมู่ 6 ศิริโชติ-สวัสดิ์กิจ</option>
      <option>หมู่ 6 ศิริชัย</option>
      <option>หมู่ 6 วัดทางหลวง</option>
      <option>หมู่ 7 ศิริชัยพัฒนา</option>
      <option>หมู่ 7 วัดโพธิ์ทองล่าง</option>
  </select>

  <!-- เลือก อสม. -->
  <label>รายชื่อ อสม.</label>
  <select id="healthVolunteer">
    <option value="">-- เลือก อสม. --</option>
  </select>

  <!-- เลือกสถานที่ -->
  <label>สถานที่</label>
  <select id="placeType">
    <option value="">-- เลือกสถานที่ --</option>
    <option>บ้าน</option>
    <option>วัด/ศาสนสถาน</option>
    <option>โรงเรียน</option>
    <option>โรงพยาบาล</option>
    <option>โรงแรม/คอนโด</option>
    <option>โรงงาน</option>
  </select>

  <!-- รายละเอียดสถานที่ -->
  <label>รายละเอียดสถานที่</label>
  <input type="text" id="placeDetail" placeholder="บ้านเลขที่, ซอย, แยก">

  <!-- ฟิลด์กรอกข้อมูล -->
  <label>จำนวนหลังคาเรือนที่สำรวจ</label>
  <input type="number" id="houseTotal">

  <label>จำนวนหลังคาเรือนที่พบลูกน้ำ</label>
  <input type="number" id="housePositive">

  <label>จำนวนภาชนะที่สำรวจ</label>
  <input type="number" id="containerTotal">

  <label>จำนวนภาชนะที่พบลูกน้ำ</label>
  <input type="number" id="containerPositive">

  <button onclick="calculate()">คำนวณ</button>

  <div class="result" id="result"></div>
</div>

<script>
  const volunteers = {
    "หมู่ 3 จาริพิบูลย์": ["นายวิเชียร นวลปลอด", "นางสาวอุทัยวรรณ สมสิทธิ์", "นางสำรวย พันธุ์ดา", "นางสารภี ตั้งธรรม",
       "นายฟรี ทองประกอบ", "นางอมรชนก นวลปลอด", "นายประเสริฐ แจ่มจันทร์", "นายวินัย นนทเกียรติกุล", "นางปราณี สังข์แก้ว", 
       "นางบุญเตือน พงษ์มาลา", "นางสาวจริยา ทองสีนาค", "นางวรกาญจน์ วรโชติพงศักดิ์", "นางสุวรรณี บุญพิทักษ์", "นางสุกัญญา เบญยมาตร", "นางสาวกาญจนา แก้วทับ"],
    "หมู่ 3 วัดฝาง": ["นางสุพรรณี เนติประเสริฐ","นางหทัยชนก หาวุฒิ","นางสาววิภาวัลย์ เกรียงเกร็ด","นางเกษม โตเจริญ",
        "นางผ่องพรรณ ภู่สุวรรณ","นางสุวัลลีย์ ประสงค์","นางวิไลรัตน์ กัญจนา","นางสาวปทุม ทองคำ","นางสุมาลี แสงชูโต",
        "นางป้อม น้ำเพชร","นางประกอบ ดิษฐใจเย็น","นางสาวกัลยา นิ่มทอง","นางลักลุณี ปั้นสุวรรณ"],
    "หมู่ 4 บางเขน": ["นางถนอม พยัคโส","นายจิรศักดิ์ แสงนุภา","นางสาวปราณี พยัคโส","นางรินดา ศรีแก้ว","นายธีระยุทธ ศรีแก้ว",
        "นายสอาด พรมเวียง","นางสาวนพรัตน์ เส็งดอนไพร","นางสงัด สอนศรี","นายสมภูมิ สุวรรณลพ","นายทรงยศ แก้วแกมสี"],
    "หมู่ 5 บางเขน": ["นางสาวพีรลิน ฐิติไชโย","นางกลอยใจ สุทธิพร","นางวรรณา ณ นคร","นางปิยะวร ศรีลักษณ์","นายเดชา กลิ่นประยงค์","นางหวัน เนตรดวงตา",
        "นายวีระพงษ์ เนตรดวงตา","นางสุวรรณา นาคทอง","นางจินดา ตำนานจิต","นางอุไรพร ใจทับทิม",],
    "หมู่ 6 ศิริโชติ-สวัสดิ์กิจ": ["นายสมกฤษ ขันสำลี","นางพรวรินทร์ นางพรวรินทร์","นางศรีอุไร สุขสวัสดิ์","นายสมบัติ สุขสวัสดิ์","นางสมจิตร ขันสำรี",
        "นางอนงค์พร ฉัตรพรไพบูลย์","นางปราณี วรพุฒ์","นางต้อย ไชยฤทธิ์","นางสุขสม ธรมธัช","นางวิลัยลักษณ์ ฉันทศิริ","นางสมทรง โพธิ์กลาง",
        "นางสาวไทรงาม ศรีภักดิ์","นายธนะสิน ธรรมสาร","นางรุจิกร ร่มสนธิ์","นางจรรยา โตขำ"],
    "หมู่ 6 ศิริชัย": ["นางสุมาลี จีนเอ็ม","นายประภัสสร สุขคำดี","นางสาวทองหยาด ใจอารีย์","นางสาวปิยรัตน์ จีนเอม","นางจิดาภา ตันเสียดี",
        "นางพิศมัย เรืองลาภ","นางณัฐชยา นนตะ","นางสุรีย์ งามชื่น","นางน้อม เรืองยุบล","นางโสภา พิณศรี","นางสำรวม พจน์ด้วง",
        "นางสาวปีณธี ศรีสถิตย์ธรรม","นางสาวยุคลทร อุบลแย้ม"],
    "หมู่ 6 วัดทางหลวง": ["นายสมเกียรติ  คงตาดำ", "นางชุรี ลายทุ้ย","นางสาวพเยาว์ อิ่มแจ่มจิตต์","นางสุชาดา จันทวาท","นางมณฑิชญา วรุณคุปต์",
        "นางธัญญลักษณ์ โพคี","นางจำเนียร ทองอ่อน","นางสมใจ พัวผดุงดิษฐ์","นางสาวปภาวรินทร์ เลขยานนท์","นางเอี่ยมเง็ก ชวาลสันติ",
        "นางสมสมัย ศิริกุลบดี","นายวีรชาติ เย็นรมย์","นายยุทธพงษ์ คัมภีรพงศ์","นางแก้วใจ คงตาดำ"],
    "หมู่ 7 ศิริชัยพัฒนา": ["นายสมจิตต์ วุฒิสุทธิ์","นางลำดวน คล้ายพันธ์","นางพเยาว์ ฝึกศิลป์","นางวัชรา มณีอินทร์","นายบุญมา จีนเอม",
        "นายเสน่ห์ คงคานิ่ง","นางสุรัตน์ดา สำราญพานิช","นายสมร สำราญพานิชย์","นางสมจิตร สำราญพานิชย์","นางสำราญ สีเมฆ","นางอุบล วุฒิสุทธิ์",
        "นางอุบล วุฒิสุทธิ์","นางบุญส่ง พุดจันทึก","นางบุญมี ซาหมื่นไวย์","นายนรินทร์ แก้วทิมา","นางสุรีพรรณ ศิริธนะ","นายอนุรักษ์ ปริญญานุวัตร",
        "นางสาวรัญจวน เค้าหาญ","นางสาวสุมาลี เปิ้นมั่นคง"],
    "หมู่ 7 วัดโพธิ์ทองล่าง": ["พ.ท.มนัส ฤกษ์วิธี", "นางเพ็ญทิวา อิงคะวะระ", "นางชญานิษฐ์ วิริยะบุศย์", "นางศรีวัลย์ ฤกษ์วิธี", "นางสมปอง พยัคกูล",
        "นางวันเพ็ญ จันทนันท์", "นางสาวเอมอร อินทร์ศิลา", "นางเตือนใจ สัญญะโรจน์", "นายสำเริง นุ่มเจริญ", "นายอรุณ อุณาพรหม",
         "นางสาวสุภาภร แซ่อึ้ง", "นางวิรีย์ บัวเขียว", "นางบุญเรือน พัดชา", "นายประยูร พิมพ์ทอง", "นางศุภรัตน์ พงษ์โพธิ์", "นางชนันญญา นักพิณพาทย์",
         "นางสาวชุติมล อิงตะวะระ", "นางประพาพรรณ์ ขุนเปีย", "นางสมบูรณ์ นพดลกนก", "นางสาวบุษบง ดีกล่ำ"]
  };

  document.getElementById("community").addEventListener("change", function() {
    const community = this.value;
    const volunteerSelect = document.getElementById("healthVolunteer");
    volunteerSelect.innerHTML = '<option value="">-- เลือก อสม. --</option>';
    if (volunteers[community]) {
      volunteers[community].forEach(name => {
        let option = document.createElement("option");
        option.value = name;
        option.textContent = name;
        volunteerSelect.appendChild(option);
      });
    }
  });

  function formatNumber(num, decimals) {
  return (num % 1 === 0) ? num.toFixed(0) : num.toFixed(decimals);
}

function calculate() {
    const houseTotal = parseInt(document.getElementById("houseTotal").value) || 0;
    const housePositive = parseInt(document.getElementById("housePositive").value) || 0;
    const containerTotal = parseInt(document.getElementById("containerTotal").value) || 0;
    const containerPositive = parseInt(document.getElementById("containerPositive").value) || 0;

    const HI = houseTotal ? (housePositive * 100 / houseTotal) : 0;
    const CI = containerTotal ? (containerPositive * 100 / containerTotal) : 0;
    const BI = houseTotal ? (containerPositive * 100 / houseTotal) : 0;

    // เก็บค่าความเสี่ยง
    let hiRisk = HI < 10 ? "ไม่มีความเสี่ยง" : "มีความเสี่ยง";
    let ciRisk = CI < 0.002 ? "ไม่มีความเสี่ยง" : "มีความเสี่ยง";
    let biRisk = BI < 50 ? "ไม่มีความเสี่ยง" : "มีความเสี่ยง";

    // แสดงผลรวมจำนวนจริง + % + ความเสี่ยง
    let resultHTML = `
        จำนวนหลังคาเรือนที่พบลูกน้ำยุงลาย (HI): 
        HI = ${formatNumber(HI,2)}% <span class="${HI<10?'green':'red'}">(${hiRisk})</span><br><br>

        จำนวนภาชนะที่พบลูกน้ำยุงลาย (CI):
        CI = ${formatNumber(CI,4)}% <span class="${CI<0.002?'green':'red'}">(${ciRisk})</span><br><br>

        ความชุกของลูกน้ำยุงลาย (BI): 
        BI = ${formatNumber(BI,2)}% <span class="${BI<50?'green':'red'}">(${biRisk})</span>
    `;
    document.getElementById("result").innerHTML = resultHTML;

    // รวมความเสี่ยงทั้งหมดเป็นตัวแปรเพื่อส่งไป Google Sheet
    const riskLevel = `HI: ${hiRisk}, CI: ${ciRisk}, BI: ${biRisk}`;

    // ส่งข้อมูลไป Google Sheet
    sendToGoogleSheet(HI.toFixed(2), CI.toFixed(4), BI.toFixed(2), riskLevel);
}

// ฟังก์ชันส่งข้อมูลไป Google Sheet
function sendToGoogleSheet(HI, CI, BI, riskLevel) {
    let month = document.getElementById('month').value;
    let community = document.getElementById('community').value;
    let volunteer = document.getElementById('healthVolunteer').value;
    let place = document.getElementById('placeType').value;
    let placeDetail = document.getElementById('placeDetail').value;

    fetch("https://script.google.com/macros/s/AKfycbzGPm9nJbTBKTgH0cVUO9a8zLCuRMIVNCD3SfkTjFgFWq9p-EqHnqGJyDLD5wy9IcGw9Q/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            month,
            community,
            volunteer,
            place,
            placeDetail,
            HI,
            CI,
            BI,
            riskLevel
        }),
        mode: "no-cors"
    })
    .then(() => console.log("Data sent successfully"))
    .catch(error => console.error("Error:", error));
}
</script>
</body>
</html>


